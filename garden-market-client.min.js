(function(e,t){typeof exports=="object"?module.exports=t(require("async"),require("request"),require("url")):typeof define=="function"&&define.amd?define(["async","reqwest","url"],t):e.garden_market_client=t(e.async,e.reqwest,e.url)})(this,function(e,t,n){function i(e,t,n){n||(n=t,t={}),typeof window=="undefined"?o(e,t,n):s(e,t,n)}function s(e,r,i){var s=n.parse(e),o="json";r.jsonp&&(o="jsonp",s.query?s.query+="&callback=?":s.query="callback=?");var u=n.format(s);t({url:u,type:o,success:function(e){i(null,e)},error:i})}function o(e,n,r){var i={url:e,json:!0};t(i,function(e,t,n){r(e,n)})}var r={};return r.getAppDetails=function(e,t){var r=n.resolve(e+"/","json");i(r,{jsonp:!0},t)},r.listApps=function(t,r,s){s||(s=r,r={});var o=n.resolve(t+"/","_db/_design/market/_list/app_versions/apps"),u=n.parse(o);u.query={},r.limit&&(u.query.limit=r.limit);if(r.apps){var a=[];r.apps.forEach(function(e){a.push([e])}),u.query.keys=a}i(n.format(u),{jsonp:!0},function(r,i){if(r)return s(r);var o=Object.keys(i);e.map(o,function(e,r){r(null,{name:e,version:i[e],url:n.resolve(t+"/","details/"+e)})},s)})},t.test?r:{getAppDetails:r.getAppDetails,listApps:r.listApps}});